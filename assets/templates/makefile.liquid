################################################################################
# Automatically-generated file. Do not edit!
################################################################################

-include {{ pathToCwd }}/makefile.init

RM := rm -rf
CC := {{ tools.c }}
CXX := {{ tools.cpp }}

# By default, build the project artefact.
all: {{ artifactName }}

# Initialise variables to collect source files.
-include variables.mk

# SUBDIR is not actively used, but is prepared in case the custom make
# parts need it. It collects subfolders that are part of the build.
SUBDIRS := 
{% for folder in sourceFolders %}
SUBDIRS += {{ folder }}
{% endfor %}

# The source files participating in the build are contributed by each folder.
{% for folder in sourceFolders %}
-include {{ folder }}/subdir.mk
{% endfor %}
# TODO test with project root
-include subdir.mk

-include objects.mk

ifneq ($(MAKECMDGOALS),clean)
{% for fileType in fileTypes %}
ifneq ($(strip $({{ fileType.prefix }}_DEPS)),)
-include $({{ fileType.prefix }}_DEPS)
endif
{% endfor %}
endif

-include {{ pathToCwd }}/makefile.defs

# Add inputs and outputs from these tool invocations to the build variables 

# Tool invocations
{{ artifactName }}: $(OBJS) $(USER_OBJS)
{% if isVerbose %}
{{ tab }}@echo ' '
{{ tab }}@echo 'Building target: $@'
{{ tab }}@echo 'Invoking: GCC C++ Linker'
{% else %}
{{ tab }}@echo '[$(CXX)]: $@'
{% endif %}
{{ tab }}{% if isVerbose == false %}@{% endif %}$(CXX)  -o "{{ artifactName }}" $(OBJS) $(USER_OBJS) $(LIBS)
{% if isVerbose %}
{{ tab }}@echo 'Finished building target: $@'
{% endif %}

# Other Targets
clean:
{% if isVerbose %}
{{ tab }}-@echo ' '
{{ tab }}-@echo 'Cleaning:'
{% else %}
{{ tab }}-@echo '[$(firstword $(RM))]:'
{% endif %}
{{ tab }}-{% if isVerbose == false %}@{% endif %}$(RM) {% for fileType in fileTypes %}$({{ fileType.prefix }}_DEPS) {% endfor %}

{{ tab }}-{% if isVerbose == false %}@{% endif %}$(RM) $(EXECUTABLES) $(OBJS) {{ artifactName }}

.PHONY: all clean dependents
.SECONDARY:

-include {{ pathToCwd }}/makefile.targets
