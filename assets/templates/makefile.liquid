################################################################################
# Automatically-generated file. Do not edit!
################################################################################

-include {{ pathToCwd }}/makefile.init

RM := rm -rf

################################################################################
# By default, build the project artefact.

all: {{ artefact.fullName }}

################################################################################
# Build definitions.

DEPS := \
{% for folder in sourceFolders -%}
{% for file in folder.files -%}
{{ file.relativePathShortNameEscaped }}.d \
{% endfor -%}
{% endfor -%}

ifneq ($(MAKECMDGOALS),clean)
ifneq ($(strip $(DEPS)),)
-include $(DEPS)
endif
endif

{{ toolchain.makeObjectsVariable }} := \
{% for folder in sourceFolders -%}
{% for file in folder.files -%}
{{ file.relativePathShortNameEscaped }}.{{ toolchain.objectExtension }} \
{% endfor -%}
{% endfor -%}

-include {{ pathToCwd }}/makefile.defs

{% for folder in sourceFolders -%}
################################################################################
# Compile files from '{{ folder.relativePath }}'.

{% for file in folder.files -%}
{{ file.relativePathShortNameEscaped }}.{{ toolchain.objectExtension }}: {{ file.buildRelativePathEscaped }}
{% if isVerbose -%}
{{ tab }}@echo ' '
{{ tab }}@echo 'Building file: {{ file.relativePath }}'
{{ tab }}@echo 'Invoking: {{ file.tool.fullDescription }}'
{% else -%}
{{ tab }}@echo '[{{ file.tool.fullCommandName }}]: {{ file.relativePath }}'
{% endif -%}
{{ tab }}{% if isVerbose == false %}@{% endif %}{{ file.fullCommand }}
{% if isVerbose -%}
{{ tab }}@echo 'Finished building: {{ file.relativePath }}'
{% endif -%}

{% endfor -%}
{% endfor -%}
################################################################################
# Build the artefact.

{{ artefact.fullName }}: $(OBJS)
{% if isVerbose -%}
{{ tab }}@echo ' '
{{ tab }}@echo 'Building target: {{ artefact.fullName }}'
{{ tab }}@echo 'Invoking: {{ root.tool.fullDescription }}'
{% else -%}
{{ tab }}@echo '[{{ root.tool.fullCommandName }}]: {{ artefact.fullName }}'
{% endif -%}
{{ tab }}{% if isVerbose == false %}@{% endif %}{{ root.fullCommand }}
{% if isVerbose -%}
{{ tab }}@echo 'Finished building target: {{ artefact.fullName }}'
{% endif -%}

################################################################################

clean:
{% if isVerbose -%}
{{ tab }}-@echo ' '
{{ tab }}-@echo 'Cleaning: all'
{% else -%}
{{ tab }}-@echo '[$(firstword $(RM))]: *'
{% endif -%}
{{ tab }}-{% if isVerbose == false %}@{% endif %}$(RM) $(DEPS)
{{ tab }}-{% if isVerbose == false %}@{% endif %}$(RM) $(OBJS) "{{ artefact.fullName }}"

################################################################################

.PHONY: all clean

-include {{ pathToCwd }}/makefile.targets
